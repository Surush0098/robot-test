<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ØªØ³Øª Ù†Ù‡Ø§ÛŒÛŒ Ø§Ø³ØªØ®ÙˆØ§Ù†â€ŒÙ‡Ø§</title>
    <style>
        body { margin: 0; background-color: #222; font-family: monospace; overflow: hidden; }
        #sidebar {
            position: absolute; top: 0; right: 0; width: 400px; height: 100vh;
            background: #111; color: #ccc; overflow-y: auto; padding: 15px;
            border-left: 3px solid #00ff00; font-size: 13px; z-index: 999;
        }
        h3 { color: white; border-bottom: 1px solid #00ff00; padding-bottom: 5px; margin-top: 0; }
        .success-box { background: #003300; border: 1px solid #00ff00; padding: 10px; margin: 10px 0; color: #00ff00; font-weight: bold; }
        .item { padding: 5px; border-bottom: 1px solid #333; }
        .highlight { color: yellow; font-weight: bold; font-size: 1.1em; }
    </style>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
</head>
<body>
    <div id="sidebar">
        <h3>Ù†ØªØ§ÛŒØ¬ Ø§Ø³Ú©Ù† Robotx.glb</h3>
        <div id="output">Ø¯Ø± Ø­Ø§Ù„ Ø®ÙˆØ§Ù†Ø¯Ù† ÙØ§ÛŒÙ„...</div>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x444444);
        const camera = new THREE.PerspectiveCamera(50, (window.innerWidth-400)/window.innerHeight, 0.1, 100);
        camera.position.set(0, 1.5, 4);
        
        const renderer = new THREE.WebGLRenderer({antialias: true});
        renderer.setSize(window.innerWidth - 400, window.innerHeight);
        document.body.appendChild(renderer.domElement);
        
        const controls = new OrbitControls(camera, renderer.domElement);
        scene.add(new THREE.AmbientLight(0xffffff, 2));
        scene.add(new THREE.DirectionalLight(0xffffff, 2));

        const out = document.getElementById('output');
        const loader = new GLTFLoader();
        
        loader.load('./Robotx.glb', function(gltf) {
            scene.add(gltf.scene);
            gltf.scene.position.y = -1;
            
            // Ù†Ù…Ø§ÛŒØ´ Ø§Ø³Ú©Ù„Øª (Ø§Ú¯Ø± ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯)
            const helper = new THREE.SkeletonHelper(gltf.scene);
            scene.add(helper);

            out.innerHTML = "";
            let bonesFound = 0;
            let headFoundName = "";

            // --- Ø¬Ø³ØªØ¬ÙˆÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ ---
            gltf.scene.traverse((o) => {
                
                // 1. Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø³ØªØ®ÙˆØ§Ù†â€ŒÙ‡Ø§ÛŒ Ù…Ø¹Ù…ÙˆÙ„ÛŒ
                if (o.isBone) {
                    bonesFound++;
                    printBone(o.name);
                    checkHead(o.name);
                }

                // 2. Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø³ØªØ®ÙˆØ§Ù†â€ŒÙ‡Ø§ÛŒ Ù…Ø®ÙÛŒ (SkinnedMesh)
                if (o.isSkinnedMesh && o.skeleton) {
                    out.innerHTML += `<div class='item' style='color:cyan'>ğŸ“¦ Ù…Ø´ Ù¾ÙˆØ³ØªÙ‡â€ŒØ¯Ø§Ø± Ù¾ÛŒØ¯Ø§ Ø´Ø¯: ${o.name}</div>`;
                    
                    o.skeleton.bones.forEach(b => {
                        // Ú†Ú© Ú©Ù†ÛŒÙ… ØªÚ©Ø±Ø§Ø±ÛŒ Ú†Ø§Ù¾ Ù†Ø´Ù‡ (Ú†ÙˆÙ† traverse Ø®ÙˆØ¯Ø´ Ù…ÛŒØ±Ù‡ Ø³Ø±Ø§ØºØ´ÙˆÙ† ÙˆÙ„ÛŒ Ù…Ø­Ø¶ Ø§Ø·Ù…ÛŒÙ†Ø§Ù†)
                        // printBone(b.name + " (inside skin)"); 
                    });
                }
            });

            if (bonesFound === 0) {
                out.innerHTML += "<h2 style='color:red'>âŒ Ù‡ÛŒÚ† Ø§Ø³ØªØ®ÙˆØ§Ù†ÛŒ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯!</h2><p>ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ú©Ø³Ù¾ÙˆØ±Øª (Export Skins) Ù‡Ù†ÙˆØ² Ù…Ø´Ú©Ù„ Ø¯Ø§Ø±Ø¯.</p>";
            } else if (headFoundName) {
                out.innerHTML = `<div class='success-box'>âœ… Ù‡Ø¯Ù Ù¾ÛŒØ¯Ø§ Ø´Ø¯!<br>NAME: ${headFoundName}</div>` + out.innerHTML;
            } else {
                out.innerHTML = `<div class='success-box' style='color:orange'>âš ï¸ Ø§Ø³ØªØ®ÙˆØ§Ù†â€ŒÙ‡Ø§ Ù‡Ø³ØªÙ†Ø¯ ÙˆÙ„ÛŒ Ø§Ø³Ù… Head Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯. Ù„ÛŒØ³Øª Ø±Ø§ Ú†Ú© Ú©Ù†ÛŒØ¯.</div>` + out.innerHTML;
            }

        }, undefined, function(e) {
            out.innerHTML = "Ø®Ø·Ø§ Ø¯Ø± Ù„ÙˆØ¯ ÙØ§ÛŒÙ„. (Ù†Ø§Ù… ÙØ§ÛŒÙ„ Robotx.glb Ø§Ø³ØªØŸ)";
        });

        function printBone(name) {
            let style = "color: #888;";
            let prefix = "ğŸ¦´ ";
            
            if (name.toLowerCase().includes('head') || name.toLowerCase().includes('neck')) {
                style = "color: yellow; font-weight:bold;";
                prefix = "ğŸ”¥ ";
            }
            out.innerHTML += `<div class='item' style='${style}'>${prefix}${name}</div>`;
        }

        function checkHead(name) {
            if (name.toLowerCase().includes('head') && !name.toLowerCase().includes('end')) {
                // Ø§Ø³Ù… Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¨Ø¹Ø¯ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒÚ©Ù†ÛŒÙ…
                // window.HEAD_NAME = name; 
            }
        }

        function animate() { requestAnimationFrame(animate); renderer.render(scene, camera); }
        animate();
    </script>
</body>
</html>